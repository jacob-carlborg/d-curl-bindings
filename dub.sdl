name "curl"
description "Static bindings for curl"
authors "Jacob Carlborg"
copyright "Copyright Â© 2023, Jacob Carlborg"
license "BSL-1.0"

dependency ":curl" version="*"

subPackage {
  name "bearssl"
  sourceFiles "dummy.d"
  targetPath "output/bearssl"
  lflags "${PACKAGE_DIR}/output/bearssl/lib/libbearssl.a" platform="posix"

  preBuildCommands `
    cd vendor/bearssl &&
    make -j $$($PACKAGE_DIR/tools/cpu_count.sh) &&
    mkdir -p $${DUB_TARGET_PATH}/include &&
    mkdir -p $${DUB_TARGET_PATH}/lib &&
    mkdir -p $${DUB_TARGET_PATH}/bin &&
    cp inc/*.h $${DUB_TARGET_PATH}/include &&
    cp build/*.a $${DUB_TARGET_PATH}/lib
  ` platform="posix"

  extraDependencyFiles \
    "vendor/bearssl/src/aead/ccm.c" \
    "vendor/bearssl/src/aead/eax.c" \
    "vendor/bearssl/src/aead/gcm.c" \
    "vendor/bearssl/src/codec/ccopy.c" \
    "vendor/bearssl/src/codec/dec16be.c" \
    "vendor/bearssl/src/codec/dec16le.c" \
    "vendor/bearssl/src/codec/dec32be.c" \
    "vendor/bearssl/src/codec/dec32le.c" \
    "vendor/bearssl/src/codec/dec64be.c" \
    "vendor/bearssl/src/codec/dec64le.c" \
    "vendor/bearssl/src/codec/enc16be.c" \
    "vendor/bearssl/src/codec/enc16le.c" \
    "vendor/bearssl/src/codec/enc32be.c" \
    "vendor/bearssl/src/codec/enc32le.c" \
    "vendor/bearssl/src/codec/enc64be.c" \
    "vendor/bearssl/src/codec/enc64le.c" \
    "vendor/bearssl/src/codec/pemdec.c" \
    "vendor/bearssl/src/codec/pemdec.t0" \
    "vendor/bearssl/src/codec/pemenc.c" \
    "vendor/bearssl/src/config.h" \
    "vendor/bearssl/src/ec/ec_all_m15.c" \
    "vendor/bearssl/src/ec/ec_all_m31.c" \
    "vendor/bearssl/src/ec/ec_c25519_i15.c" \
    "vendor/bearssl/src/ec/ec_c25519_i31.c" \
    "vendor/bearssl/src/ec/ec_c25519_m15.c" \
    "vendor/bearssl/src/ec/ec_c25519_m31.c" \
    "vendor/bearssl/src/ec/ec_c25519_m62.c" \
    "vendor/bearssl/src/ec/ec_c25519_m64.c" \
    "vendor/bearssl/src/ec/ec_curve25519.c" \
    "vendor/bearssl/src/ec/ec_default.c" \
    "vendor/bearssl/src/ec/ec_keygen.c" \
    "vendor/bearssl/src/ec/ec_p256_m15.c" \
    "vendor/bearssl/src/ec/ec_p256_m31.c" \
    "vendor/bearssl/src/ec/ec_p256_m62.c" \
    "vendor/bearssl/src/ec/ec_p256_m64.c" \
    "vendor/bearssl/src/ec/ec_prime_i15.c" \
    "vendor/bearssl/src/ec/ec_prime_i31.c" \
    "vendor/bearssl/src/ec/ec_pubkey.c" \
    "vendor/bearssl/src/ec/ec_secp256r1.c" \
    "vendor/bearssl/src/ec/ec_secp384r1.c" \
    "vendor/bearssl/src/ec/ec_secp521r1.c" \
    "vendor/bearssl/src/ec/ecdsa_atr.c" \
    "vendor/bearssl/src/ec/ecdsa_default_sign_asn1.c" \
    "vendor/bearssl/src/ec/ecdsa_default_sign_raw.c" \
    "vendor/bearssl/src/ec/ecdsa_default_vrfy_asn1.c" \
    "vendor/bearssl/src/ec/ecdsa_default_vrfy_raw.c" \
    "vendor/bearssl/src/ec/ecdsa_i15_bits.c" \
    "vendor/bearssl/src/ec/ecdsa_i15_sign_asn1.c" \
    "vendor/bearssl/src/ec/ecdsa_i15_sign_raw.c" \
    "vendor/bearssl/src/ec/ecdsa_i15_vrfy_asn1.c" \
    "vendor/bearssl/src/ec/ecdsa_i15_vrfy_raw.c" \
    "vendor/bearssl/src/ec/ecdsa_i31_bits.c" \
    "vendor/bearssl/src/ec/ecdsa_i31_sign_asn1.c" \
    "vendor/bearssl/src/ec/ecdsa_i31_sign_raw.c" \
    "vendor/bearssl/src/ec/ecdsa_i31_vrfy_asn1.c" \
    "vendor/bearssl/src/ec/ecdsa_i31_vrfy_raw.c" \
    "vendor/bearssl/src/ec/ecdsa_rta.c" \
    "vendor/bearssl/src/hash/dig_oid.c" \
    "vendor/bearssl/src/hash/dig_size.c" \
    "vendor/bearssl/src/hash/ghash_ctmul.c" \
    "vendor/bearssl/src/hash/ghash_ctmul32.c" \
    "vendor/bearssl/src/hash/ghash_ctmul64.c" \
    "vendor/bearssl/src/hash/ghash_pclmul.c" \
    "vendor/bearssl/src/hash/ghash_pwr8.c" \
    "vendor/bearssl/src/hash/md5.c" \
    "vendor/bearssl/src/hash/md5sha1.c" \
    "vendor/bearssl/src/hash/mgf1.c" \
    "vendor/bearssl/src/hash/multihash.c" \
    "vendor/bearssl/src/hash/sha1.c" \
    "vendor/bearssl/src/hash/sha2big.c" \
    "vendor/bearssl/src/hash/sha2small.c" \
    "vendor/bearssl/src/inner.h" \
    "vendor/bearssl/src/int/i15_add.c" \
    "vendor/bearssl/src/int/i15_bitlen.c" \
    "vendor/bearssl/src/int/i15_decmod.c" \
    "vendor/bearssl/src/int/i15_decode.c" \
    "vendor/bearssl/src/int/i15_decred.c" \
    "vendor/bearssl/src/int/i15_encode.c" \
    "vendor/bearssl/src/int/i15_fmont.c" \
    "vendor/bearssl/src/int/i15_iszero.c" \
    "vendor/bearssl/src/int/i15_moddiv.c" \
    "vendor/bearssl/src/int/i15_modpow.c" \
    "vendor/bearssl/src/int/i15_modpow2.c" \
    "vendor/bearssl/src/int/i15_montmul.c" \
    "vendor/bearssl/src/int/i15_mulacc.c" \
    "vendor/bearssl/src/int/i15_muladd.c" \
    "vendor/bearssl/src/int/i15_ninv15.c" \
    "vendor/bearssl/src/int/i15_reduce.c" \
    "vendor/bearssl/src/int/i15_rshift.c" \
    "vendor/bearssl/src/int/i15_sub.c" \
    "vendor/bearssl/src/int/i15_tmont.c" \
    "vendor/bearssl/src/int/i31_add.c" \
    "vendor/bearssl/src/int/i31_bitlen.c" \
    "vendor/bearssl/src/int/i31_decmod.c" \
    "vendor/bearssl/src/int/i31_decode.c" \
    "vendor/bearssl/src/int/i31_decred.c" \
    "vendor/bearssl/src/int/i31_encode.c" \
    "vendor/bearssl/src/int/i31_fmont.c" \
    "vendor/bearssl/src/int/i31_iszero.c" \
    "vendor/bearssl/src/int/i31_moddiv.c" \
    "vendor/bearssl/src/int/i31_modpow.c" \
    "vendor/bearssl/src/int/i31_modpow2.c" \
    "vendor/bearssl/src/int/i31_montmul.c" \
    "vendor/bearssl/src/int/i31_mulacc.c" \
    "vendor/bearssl/src/int/i31_muladd.c" \
    "vendor/bearssl/src/int/i31_ninv31.c" \
    "vendor/bearssl/src/int/i31_reduce.c" \
    "vendor/bearssl/src/int/i31_rshift.c" \
    "vendor/bearssl/src/int/i31_sub.c" \
    "vendor/bearssl/src/int/i31_tmont.c" \
    "vendor/bearssl/src/int/i32_add.c" \
    "vendor/bearssl/src/int/i32_bitlen.c" \
    "vendor/bearssl/src/int/i32_decmod.c" \
    "vendor/bearssl/src/int/i32_decode.c" \
    "vendor/bearssl/src/int/i32_decred.c" \
    "vendor/bearssl/src/int/i32_div32.c" \
    "vendor/bearssl/src/int/i32_encode.c" \
    "vendor/bearssl/src/int/i32_fmont.c" \
    "vendor/bearssl/src/int/i32_iszero.c" \
    "vendor/bearssl/src/int/i32_modpow.c" \
    "vendor/bearssl/src/int/i32_montmul.c" \
    "vendor/bearssl/src/int/i32_mulacc.c" \
    "vendor/bearssl/src/int/i32_muladd.c" \
    "vendor/bearssl/src/int/i32_ninv32.c" \
    "vendor/bearssl/src/int/i32_reduce.c" \
    "vendor/bearssl/src/int/i32_sub.c" \
    "vendor/bearssl/src/int/i32_tmont.c" \
    "vendor/bearssl/src/int/i62_modpow2.c" \
    "vendor/bearssl/src/kdf/hkdf.c" \
    "vendor/bearssl/src/kdf/shake.c" \
    "vendor/bearssl/src/mac/hmac.c" \
    "vendor/bearssl/src/mac/hmac_ct.c" \
    "vendor/bearssl/src/rand/aesctr_drbg.c" \
    "vendor/bearssl/src/rand/hmac_drbg.c" \
    "vendor/bearssl/src/rand/sysrng.c" \
    "vendor/bearssl/src/rsa/rsa_default_keygen.c" \
    "vendor/bearssl/src/rsa/rsa_default_modulus.c" \
    "vendor/bearssl/src/rsa/rsa_default_oaep_decrypt.c" \
    "vendor/bearssl/src/rsa/rsa_default_oaep_encrypt.c" \
    "vendor/bearssl/src/rsa/rsa_default_pkcs1_sign.c" \
    "vendor/bearssl/src/rsa/rsa_default_pkcs1_vrfy.c" \
    "vendor/bearssl/src/rsa/rsa_default_priv.c" \
    "vendor/bearssl/src/rsa/rsa_default_privexp.c" \
    "vendor/bearssl/src/rsa/rsa_default_pss_sign.c" \
    "vendor/bearssl/src/rsa/rsa_default_pss_vrfy.c" \
    "vendor/bearssl/src/rsa/rsa_default_pub.c" \
    "vendor/bearssl/src/rsa/rsa_default_pubexp.c" \
    "vendor/bearssl/src/rsa/rsa_i15_keygen.c" \
    "vendor/bearssl/src/rsa/rsa_i15_modulus.c" \
    "vendor/bearssl/src/rsa/rsa_i15_oaep_decrypt.c" \
    "vendor/bearssl/src/rsa/rsa_i15_oaep_encrypt.c" \
    "vendor/bearssl/src/rsa/rsa_i15_pkcs1_sign.c" \
    "vendor/bearssl/src/rsa/rsa_i15_pkcs1_vrfy.c" \
    "vendor/bearssl/src/rsa/rsa_i15_priv.c" \
    "vendor/bearssl/src/rsa/rsa_i15_privexp.c" \
    "vendor/bearssl/src/rsa/rsa_i15_pss_sign.c" \
    "vendor/bearssl/src/rsa/rsa_i15_pss_vrfy.c" \
    "vendor/bearssl/src/rsa/rsa_i15_pub.c" \
    "vendor/bearssl/src/rsa/rsa_i15_pubexp.c" \
    "vendor/bearssl/src/rsa/rsa_i31_keygen.c" \
    "vendor/bearssl/src/rsa/rsa_i31_keygen_inner.c" \
    "vendor/bearssl/src/rsa/rsa_i31_modulus.c" \
    "vendor/bearssl/src/rsa/rsa_i31_oaep_decrypt.c" \
    "vendor/bearssl/src/rsa/rsa_i31_oaep_encrypt.c" \
    "vendor/bearssl/src/rsa/rsa_i31_pkcs1_sign.c" \
    "vendor/bearssl/src/rsa/rsa_i31_pkcs1_vrfy.c" \
    "vendor/bearssl/src/rsa/rsa_i31_priv.c" \
    "vendor/bearssl/src/rsa/rsa_i31_privexp.c" \
    "vendor/bearssl/src/rsa/rsa_i31_pss_sign.c" \
    "vendor/bearssl/src/rsa/rsa_i31_pss_vrfy.c" \
    "vendor/bearssl/src/rsa/rsa_i31_pub.c" \
    "vendor/bearssl/src/rsa/rsa_i31_pubexp.c" \
    "vendor/bearssl/src/rsa/rsa_i32_oaep_decrypt.c" \
    "vendor/bearssl/src/rsa/rsa_i32_oaep_encrypt.c" \
    "vendor/bearssl/src/rsa/rsa_i32_pkcs1_sign.c" \
    "vendor/bearssl/src/rsa/rsa_i32_pkcs1_vrfy.c" \
    "vendor/bearssl/src/rsa/rsa_i32_priv.c" \
    "vendor/bearssl/src/rsa/rsa_i32_pss_sign.c" \
    "vendor/bearssl/src/rsa/rsa_i32_pss_vrfy.c" \
    "vendor/bearssl/src/rsa/rsa_i32_pub.c" \
    "vendor/bearssl/src/rsa/rsa_i62_keygen.c" \
    "vendor/bearssl/src/rsa/rsa_i62_oaep_decrypt.c" \
    "vendor/bearssl/src/rsa/rsa_i62_oaep_encrypt.c" \
    "vendor/bearssl/src/rsa/rsa_i62_pkcs1_sign.c" \
    "vendor/bearssl/src/rsa/rsa_i62_pkcs1_vrfy.c" \
    "vendor/bearssl/src/rsa/rsa_i62_priv.c" \
    "vendor/bearssl/src/rsa/rsa_i62_pss_sign.c" \
    "vendor/bearssl/src/rsa/rsa_i62_pss_vrfy.c" \
    "vendor/bearssl/src/rsa/rsa_i62_pub.c" \
    "vendor/bearssl/src/rsa/rsa_oaep_pad.c" \
    "vendor/bearssl/src/rsa/rsa_oaep_unpad.c" \
    "vendor/bearssl/src/rsa/rsa_pkcs1_sig_pad.c" \
    "vendor/bearssl/src/rsa/rsa_pkcs1_sig_unpad.c" \
    "vendor/bearssl/src/rsa/rsa_pss_sig_pad.c" \
    "vendor/bearssl/src/rsa/rsa_pss_sig_unpad.c" \
    "vendor/bearssl/src/rsa/rsa_ssl_decrypt.c" \
    "vendor/bearssl/src/settings.c" \
    "vendor/bearssl/src/ssl/prf.c" \
    "vendor/bearssl/src/ssl/prf_md5sha1.c" \
    "vendor/bearssl/src/ssl/prf_sha256.c" \
    "vendor/bearssl/src/ssl/prf_sha384.c" \
    "vendor/bearssl/src/ssl/ssl_ccert_single_ec.c" \
    "vendor/bearssl/src/ssl/ssl_ccert_single_rsa.c" \
    "vendor/bearssl/src/ssl/ssl_client.c" \
    "vendor/bearssl/src/ssl/ssl_client_default_rsapub.c" \
    "vendor/bearssl/src/ssl/ssl_client_full.c" \
    "vendor/bearssl/src/ssl/ssl_engine.c" \
    "vendor/bearssl/src/ssl/ssl_engine_default_aescbc.c" \
    "vendor/bearssl/src/ssl/ssl_engine_default_aesccm.c" \
    "vendor/bearssl/src/ssl/ssl_engine_default_aesgcm.c" \
    "vendor/bearssl/src/ssl/ssl_engine_default_chapol.c" \
    "vendor/bearssl/src/ssl/ssl_engine_default_descbc.c" \
    "vendor/bearssl/src/ssl/ssl_engine_default_ec.c" \
    "vendor/bearssl/src/ssl/ssl_engine_default_ecdsa.c" \
    "vendor/bearssl/src/ssl/ssl_engine_default_rsavrfy.c" \
    "vendor/bearssl/src/ssl/ssl_hashes.c" \
    "vendor/bearssl/src/ssl/ssl_hs_client.c" \
    "vendor/bearssl/src/ssl/ssl_hs_client.t0" \
    "vendor/bearssl/src/ssl/ssl_hs_common.t0" \
    "vendor/bearssl/src/ssl/ssl_hs_server.c" \
    "vendor/bearssl/src/ssl/ssl_hs_server.t0" \
    "vendor/bearssl/src/ssl/ssl_io.c" \
    "vendor/bearssl/src/ssl/ssl_keyexport.c" \
    "vendor/bearssl/src/ssl/ssl_lru.c" \
    "vendor/bearssl/src/ssl/ssl_rec_cbc.c" \
    "vendor/bearssl/src/ssl/ssl_rec_ccm.c" \
    "vendor/bearssl/src/ssl/ssl_rec_chapol.c" \
    "vendor/bearssl/src/ssl/ssl_rec_gcm.c" \
    "vendor/bearssl/src/ssl/ssl_scert_single_ec.c" \
    "vendor/bearssl/src/ssl/ssl_scert_single_rsa.c" \
    "vendor/bearssl/src/ssl/ssl_server.c" \
    "vendor/bearssl/src/ssl/ssl_server_full_ec.c" \
    "vendor/bearssl/src/ssl/ssl_server_full_rsa.c" \
    "vendor/bearssl/src/ssl/ssl_server_mine2c.c" \
    "vendor/bearssl/src/ssl/ssl_server_mine2g.c" \
    "vendor/bearssl/src/ssl/ssl_server_minf2c.c" \
    "vendor/bearssl/src/ssl/ssl_server_minf2g.c" \
    "vendor/bearssl/src/ssl/ssl_server_minr2g.c" \
    "vendor/bearssl/src/ssl/ssl_server_minu2g.c" \
    "vendor/bearssl/src/ssl/ssl_server_minv2g.c" \
    "vendor/bearssl/src/symcipher/aes_big_cbcdec.c" \
    "vendor/bearssl/src/symcipher/aes_big_cbcenc.c" \
    "vendor/bearssl/src/symcipher/aes_big_ctr.c" \
    "vendor/bearssl/src/symcipher/aes_big_ctrcbc.c" \
    "vendor/bearssl/src/symcipher/aes_big_dec.c" \
    "vendor/bearssl/src/symcipher/aes_big_enc.c" \
    "vendor/bearssl/src/symcipher/aes_common.c" \
    "vendor/bearssl/src/symcipher/aes_ct.c" \
    "vendor/bearssl/src/symcipher/aes_ct64.c" \
    "vendor/bearssl/src/symcipher/aes_ct64_cbcdec.c" \
    "vendor/bearssl/src/symcipher/aes_ct64_cbcenc.c" \
    "vendor/bearssl/src/symcipher/aes_ct64_ctr.c" \
    "vendor/bearssl/src/symcipher/aes_ct64_ctrcbc.c" \
    "vendor/bearssl/src/symcipher/aes_ct64_dec.c" \
    "vendor/bearssl/src/symcipher/aes_ct64_enc.c" \
    "vendor/bearssl/src/symcipher/aes_ct_cbcdec.c" \
    "vendor/bearssl/src/symcipher/aes_ct_cbcenc.c" \
    "vendor/bearssl/src/symcipher/aes_ct_ctr.c" \
    "vendor/bearssl/src/symcipher/aes_ct_ctrcbc.c" \
    "vendor/bearssl/src/symcipher/aes_ct_dec.c" \
    "vendor/bearssl/src/symcipher/aes_ct_enc.c" \
    "vendor/bearssl/src/symcipher/aes_pwr8.c" \
    "vendor/bearssl/src/symcipher/aes_pwr8_cbcdec.c" \
    "vendor/bearssl/src/symcipher/aes_pwr8_cbcenc.c" \
    "vendor/bearssl/src/symcipher/aes_pwr8_ctr.c" \
    "vendor/bearssl/src/symcipher/aes_pwr8_ctrcbc.c" \
    "vendor/bearssl/src/symcipher/aes_small_cbcdec.c" \
    "vendor/bearssl/src/symcipher/aes_small_cbcenc.c" \
    "vendor/bearssl/src/symcipher/aes_small_ctr.c" \
    "vendor/bearssl/src/symcipher/aes_small_ctrcbc.c" \
    "vendor/bearssl/src/symcipher/aes_small_dec.c" \
    "vendor/bearssl/src/symcipher/aes_small_enc.c" \
    "vendor/bearssl/src/symcipher/aes_x86ni.c" \
    "vendor/bearssl/src/symcipher/aes_x86ni_cbcdec.c" \
    "vendor/bearssl/src/symcipher/aes_x86ni_cbcenc.c" \
    "vendor/bearssl/src/symcipher/aes_x86ni_ctr.c" \
    "vendor/bearssl/src/symcipher/aes_x86ni_ctrcbc.c" \
    "vendor/bearssl/src/symcipher/chacha20_ct.c" \
    "vendor/bearssl/src/symcipher/chacha20_sse2.c" \
    "vendor/bearssl/src/symcipher/des_ct.c" \
    "vendor/bearssl/src/symcipher/des_ct_cbcdec.c" \
    "vendor/bearssl/src/symcipher/des_ct_cbcenc.c" \
    "vendor/bearssl/src/symcipher/des_support.c" \
    "vendor/bearssl/src/symcipher/des_tab.c" \
    "vendor/bearssl/src/symcipher/des_tab_cbcdec.c" \
    "vendor/bearssl/src/symcipher/des_tab_cbcenc.c" \
    "vendor/bearssl/src/symcipher/poly1305_ctmul.c" \
    "vendor/bearssl/src/symcipher/poly1305_ctmul32.c" \
    "vendor/bearssl/src/symcipher/poly1305_ctmulq.c" \
    "vendor/bearssl/src/symcipher/poly1305_i15.c" \
    "vendor/bearssl/src/x509/asn1.t0" \
    "vendor/bearssl/src/x509/asn1enc.c" \
    "vendor/bearssl/src/x509/encode_ec_pk8der.c" \
    "vendor/bearssl/src/x509/encode_ec_rawder.c" \
    "vendor/bearssl/src/x509/encode_rsa_pk8der.c" \
    "vendor/bearssl/src/x509/encode_rsa_rawder.c" \
    "vendor/bearssl/src/x509/skey_decoder.c" \
    "vendor/bearssl/src/x509/skey_decoder.t0" \
    "vendor/bearssl/src/x509/x509_decoder.c" \
    "vendor/bearssl/src/x509/x509_decoder.t0" \
    "vendor/bearssl/src/x509/x509_knownkey.c" \
    "vendor/bearssl/src/x509/x509_minimal.c" \
    "vendor/bearssl/src/x509/x509_minimal.t0" \
    "vendor/bearssl/src/x509/x509_minimal_full.c"
}

subPackage {
  name "curl"
  sourceFiles "dummy.d"
  targetPath "output/curl"

  lflags "${PACKAGE_DIR}/output/curl/lib/libcurl.a"
  lflags \
    "-framework" "CoreFoundation" \
    "-framework" "SystemConfiguration" \
    platform="osx"

  dependency "curl:nghttp2" version="*"
  dependency "curl:bearssl" version="*"
  dependency "curl:zlib" version="*"

  preBuildCommands `
    cd vendor/curl &&
    autoreconf -fi &&
    ./configure \
      --enable-optimize \
      --disable-shared \
      --disable-ldap \
      --disable-manual \
      --without-libidn2 \
      --prefix="$${DUB_TARGET_PATH}" \
      --with-bearssl="$${DUB_TARGET_PATH}/../bearssl" \
      --with-nghttp2="$${DUB_TARGET_PATH}/../nghttp2" \
      --with-zlib="$${DUB_TARGET_PATH}/../zlib" &&
    make install -j $$($PACKAGE_DIR/tools/cpu_count.sh)
  ` platform="posix"
}

subPackage {
  name "nghttp2"
  sourceFiles "dummy.d"
  targetPath "output/nghttp2"
  lflags "${PACKAGE_DIR}/output/nghttp2/lib/libnghttp2.a"

  preBuildCommands `
    cd vendor/nghttp2 &&
    autoreconf -i &&
    autoconf &&
    automake &&
    ./configure \
      --disable-shared \
      --enable-lib-only \
      --prefix="$${DUB_TARGET_PATH}" &&
    make install -j $$($PACKAGE_DIR/tools/cpu_count.sh)
  ` platform="posix"

  extraDependencyFiles \
    "vendor/nghttp2/src/CMakeLists.txt" \
    "vendor/nghttp2/src/HtmlParser.cc" \
    "vendor/nghttp2/src/HtmlParser.h" \
    "vendor/nghttp2/src/HttpServer.cc" \
    "vendor/nghttp2/src/HttpServer.h" \
    "vendor/nghttp2/src/Makefile" \
    "vendor/nghttp2/src/Makefile.am" \
    "vendor/nghttp2/src/Makefile.in" \
    "vendor/nghttp2/src/allocator.h" \
    "vendor/nghttp2/src/app_helper.cc" \
    "vendor/nghttp2/src/app_helper.h" \
    "vendor/nghttp2/src/base64.h" \
    "vendor/nghttp2/src/base64_test.cc" \
    "vendor/nghttp2/src/base64_test.h" \
    "vendor/nghttp2/src/buffer.h" \
    "vendor/nghttp2/src/buffer_test.cc" \
    "vendor/nghttp2/src/buffer_test.h" \
    "vendor/nghttp2/src/ca-config.json" \
    "vendor/nghttp2/src/ca.nghttp2.org-key.pem" \
    "vendor/nghttp2/src/ca.nghttp2.org.csr" \
    "vendor/nghttp2/src/ca.nghttp2.org.csr.json" \
    "vendor/nghttp2/src/ca.nghttp2.org.pem" \
    "vendor/nghttp2/src/comp_helper.c" \
    "vendor/nghttp2/src/comp_helper.h" \
    "vendor/nghttp2/src/deflatehd.cc" \
    "vendor/nghttp2/src/h2load.cc" \
    "vendor/nghttp2/src/h2load.h" \
    "vendor/nghttp2/src/h2load_http1_session.cc" \
    "vendor/nghttp2/src/h2load_http1_session.h" \
    "vendor/nghttp2/src/h2load_http2_session.cc" \
    "vendor/nghttp2/src/h2load_http2_session.h" \
    "vendor/nghttp2/src/h2load_http3_session.cc" \
    "vendor/nghttp2/src/h2load_http3_session.h" \
    "vendor/nghttp2/src/h2load_quic.cc" \
    "vendor/nghttp2/src/h2load_quic.h" \
    "vendor/nghttp2/src/h2load_session.h" \
    "vendor/nghttp2/src/http-parser.patch" \
    "vendor/nghttp2/src/http2.cc" \
    "vendor/nghttp2/src/http2.h" \
    "vendor/nghttp2/src/http2_test.cc" \
    "vendor/nghttp2/src/http2_test.h" \
    "vendor/nghttp2/src/http3.cc" \
    "vendor/nghttp2/src/http3.h" \
    "vendor/nghttp2/src/inflatehd.cc" \
    "vendor/nghttp2/src/libevent_util.cc" \
    "vendor/nghttp2/src/libevent_util.h" \
    "vendor/nghttp2/src/memchunk.h" \
    "vendor/nghttp2/src/memchunk_test.cc" \
    "vendor/nghttp2/src/memchunk_test.h" \
    "vendor/nghttp2/src/network.h" \
    "vendor/nghttp2/src/nghttp.cc" \
    "vendor/nghttp2/src/nghttp.h" \
    "vendor/nghttp2/src/nghttp2_config.h" \
    "vendor/nghttp2/src/nghttp2_gzip.c" \
    "vendor/nghttp2/src/nghttp2_gzip.h" \
    "vendor/nghttp2/src/nghttp2_gzip_test.c" \
    "vendor/nghttp2/src/nghttp2_gzip_test.h" \
    "vendor/nghttp2/src/nghttpd.cc" \
    "vendor/nghttp2/src/quic.cc" \
    "vendor/nghttp2/src/quic.h" \
    "vendor/nghttp2/src/shrpx-unittest.cc" \
    "vendor/nghttp2/src/shrpx.cc" \
    "vendor/nghttp2/src/shrpx.h" \
    "vendor/nghttp2/src/shrpx_accept_handler.cc" \
    "vendor/nghttp2/src/shrpx_accept_handler.h" \
    "vendor/nghttp2/src/shrpx_api_downstream_connection.cc" \
    "vendor/nghttp2/src/shrpx_api_downstream_connection.h" \
    "vendor/nghttp2/src/shrpx_client_handler.cc" \
    "vendor/nghttp2/src/shrpx_client_handler.h" \
    "vendor/nghttp2/src/shrpx_config.cc" \
    "vendor/nghttp2/src/shrpx_config.h" \
    "vendor/nghttp2/src/shrpx_config_test.cc" \
    "vendor/nghttp2/src/shrpx_config_test.h" \
    "vendor/nghttp2/src/shrpx_connect_blocker.cc" \
    "vendor/nghttp2/src/shrpx_connect_blocker.h" \
    "vendor/nghttp2/src/shrpx_connection.cc" \
    "vendor/nghttp2/src/shrpx_connection.h" \
    "vendor/nghttp2/src/shrpx_connection_handler.cc" \
    "vendor/nghttp2/src/shrpx_connection_handler.h" \
    "vendor/nghttp2/src/shrpx_dns_resolver.cc" \
    "vendor/nghttp2/src/shrpx_dns_resolver.h" \
    "vendor/nghttp2/src/shrpx_dns_tracker.cc" \
    "vendor/nghttp2/src/shrpx_dns_tracker.h" \
    "vendor/nghttp2/src/shrpx_downstream.cc" \
    "vendor/nghttp2/src/shrpx_downstream.h" \
    "vendor/nghttp2/src/shrpx_downstream_connection.cc" \
    "vendor/nghttp2/src/shrpx_downstream_connection.h" \
    "vendor/nghttp2/src/shrpx_downstream_connection_pool.cc" \
    "vendor/nghttp2/src/shrpx_downstream_connection_pool.h" \
    "vendor/nghttp2/src/shrpx_downstream_queue.cc" \
    "vendor/nghttp2/src/shrpx_downstream_queue.h" \
    "vendor/nghttp2/src/shrpx_downstream_test.cc" \
    "vendor/nghttp2/src/shrpx_downstream_test.h" \
    "vendor/nghttp2/src/shrpx_dual_dns_resolver.cc" \
    "vendor/nghttp2/src/shrpx_dual_dns_resolver.h" \
    "vendor/nghttp2/src/shrpx_error.h" \
    "vendor/nghttp2/src/shrpx_exec.cc" \
    "vendor/nghttp2/src/shrpx_exec.h" \
    "vendor/nghttp2/src/shrpx_health_monitor_downstream_connection.cc" \
    "vendor/nghttp2/src/shrpx_health_monitor_downstream_connection.h" \
    "vendor/nghttp2/src/shrpx_http.cc" \
    "vendor/nghttp2/src/shrpx_http.h" \
    "vendor/nghttp2/src/shrpx_http2_downstream_connection.cc" \
    "vendor/nghttp2/src/shrpx_http2_downstream_connection.h" \
    "vendor/nghttp2/src/shrpx_http2_session.cc" \
    "vendor/nghttp2/src/shrpx_http2_session.h" \
    "vendor/nghttp2/src/shrpx_http2_upstream.cc" \
    "vendor/nghttp2/src/shrpx_http2_upstream.h" \
    "vendor/nghttp2/src/shrpx_http3_upstream.cc" \
    "vendor/nghttp2/src/shrpx_http3_upstream.h" \
    "vendor/nghttp2/src/shrpx_http_downstream_connection.cc" \
    "vendor/nghttp2/src/shrpx_http_downstream_connection.h" \
    "vendor/nghttp2/src/shrpx_http_test.cc" \
    "vendor/nghttp2/src/shrpx_http_test.h" \
    "vendor/nghttp2/src/shrpx_https_upstream.cc" \
    "vendor/nghttp2/src/shrpx_https_upstream.h" \
    "vendor/nghttp2/src/shrpx_io_control.cc" \
    "vendor/nghttp2/src/shrpx_io_control.h" \
    "vendor/nghttp2/src/shrpx_live_check.cc" \
    "vendor/nghttp2/src/shrpx_live_check.h" \
    "vendor/nghttp2/src/shrpx_log.cc" \
    "vendor/nghttp2/src/shrpx_log.h" \
    "vendor/nghttp2/src/shrpx_log_config.cc" \
    "vendor/nghttp2/src/shrpx_log_config.h" \
    "vendor/nghttp2/src/shrpx_memcached_connection.cc" \
    "vendor/nghttp2/src/shrpx_memcached_connection.h" \
    "vendor/nghttp2/src/shrpx_memcached_dispatcher.cc" \
    "vendor/nghttp2/src/shrpx_memcached_dispatcher.h" \
    "vendor/nghttp2/src/shrpx_memcached_request.h" \
    "vendor/nghttp2/src/shrpx_memcached_result.h" \
    "vendor/nghttp2/src/shrpx_mruby.cc" \
    "vendor/nghttp2/src/shrpx_mruby.h" \
    "vendor/nghttp2/src/shrpx_mruby_module.cc" \
    "vendor/nghttp2/src/shrpx_mruby_module.h" \
    "vendor/nghttp2/src/shrpx_mruby_module_env.cc" \
    "vendor/nghttp2/src/shrpx_mruby_module_env.h" \
    "vendor/nghttp2/src/shrpx_mruby_module_request.cc" \
    "vendor/nghttp2/src/shrpx_mruby_module_request.h" \
    "vendor/nghttp2/src/shrpx_mruby_module_response.cc" \
    "vendor/nghttp2/src/shrpx_mruby_module_response.h" \
    "vendor/nghttp2/src/shrpx_null_downstream_connection.cc" \
    "vendor/nghttp2/src/shrpx_null_downstream_connection.h" \
    "vendor/nghttp2/src/shrpx_process.h" \
    "vendor/nghttp2/src/shrpx_quic.cc" \
    "vendor/nghttp2/src/shrpx_quic.h" \
    "vendor/nghttp2/src/shrpx_quic_connection_handler.cc" \
    "vendor/nghttp2/src/shrpx_quic_connection_handler.h" \
    "vendor/nghttp2/src/shrpx_quic_listener.cc" \
    "vendor/nghttp2/src/shrpx_quic_listener.h" \
    "vendor/nghttp2/src/shrpx_rate_limit.cc" \
    "vendor/nghttp2/src/shrpx_rate_limit.h" \
    "vendor/nghttp2/src/shrpx_router.cc" \
    "vendor/nghttp2/src/shrpx_router.h" \
    "vendor/nghttp2/src/shrpx_router_test.cc" \
    "vendor/nghttp2/src/shrpx_router_test.h" \
    "vendor/nghttp2/src/shrpx_signal.cc" \
    "vendor/nghttp2/src/shrpx_signal.h" \
    "vendor/nghttp2/src/shrpx_tls.cc" \
    "vendor/nghttp2/src/shrpx_tls.h" \
    "vendor/nghttp2/src/shrpx_tls_test.cc" \
    "vendor/nghttp2/src/shrpx_tls_test.h" \
    "vendor/nghttp2/src/shrpx_upstream.h" \
    "vendor/nghttp2/src/shrpx_worker.cc" \
    "vendor/nghttp2/src/shrpx_worker.h" \
    "vendor/nghttp2/src/shrpx_worker_process.cc" \
    "vendor/nghttp2/src/shrpx_worker_process.h" \
    "vendor/nghttp2/src/shrpx_worker_test.cc" \
    "vendor/nghttp2/src/shrpx_worker_test.h" \
    "vendor/nghttp2/src/ssl_compat.h" \
    "vendor/nghttp2/src/template.h" \
    "vendor/nghttp2/src/template_test.cc" \
    "vendor/nghttp2/src/template_test.h" \
    "vendor/nghttp2/src/test.example.com-key.pem" \
    "vendor/nghttp2/src/test.example.com.csr" \
    "vendor/nghttp2/src/test.example.com.csr.json" \
    "vendor/nghttp2/src/test.example.com.pem" \
    "vendor/nghttp2/src/test.nghttp2.org-key.pem" \
    "vendor/nghttp2/src/test.nghttp2.org.csr" \
    "vendor/nghttp2/src/test.nghttp2.org.csr.json" \
    "vendor/nghttp2/src/test.nghttp2.org.pem" \
    "vendor/nghttp2/src/timegm.c" \
    "vendor/nghttp2/src/timegm.h" \
    "vendor/nghttp2/src/tls.cc" \
    "vendor/nghttp2/src/tls.h" \
    "vendor/nghttp2/src/util.cc" \
    "vendor/nghttp2/src/util.h" \
    "vendor/nghttp2/src/util_test.cc" \
    "vendor/nghttp2/src/util_test.h" \
    "vendor/nghttp2/src/xsi_strerror.c" \
    "vendor/nghttp2/src/xsi_strerror.h"
}

subPackage {
  name "zlib"
  sourceFiles "dummy.d"
  targetPath "output/zlib"
  lflags "${PACKAGE_DIR}/output/zlib/lib/libz.a"

  preBuildCommands `
    cd vendor/zlib &&
    ./configure \
      --static \
      --prefix="$${DUB_TARGET_PATH}" &&
    make install -j $$($PACKAGE_DIR/tools/cpu_count.sh)
  ` platform="posix"

  extraDependencyFiles \
    "vendor/zlib/CMakeLists.txt" \
    "vendor/zlib/ChangeLog" \
    "vendor/zlib/FAQ" \
    "vendor/zlib/INDEX" \
    "vendor/zlib/LICENSE" \
    "vendor/zlib/Makefile" \
    "vendor/zlib/Makefile.in" \
    "vendor/zlib/README" \
    "vendor/zlib/adler32.c" \
    "vendor/zlib/compress.c" \
    "vendor/zlib/configure" \
    "vendor/zlib/crc32.c" \
    "vendor/zlib/crc32.h" \
    "vendor/zlib/deflate.c" \
    "vendor/zlib/deflate.h" \
    "vendor/zlib/gzclose.c" \
    "vendor/zlib/gzguts.h" \
    "vendor/zlib/gzlib.c" \
    "vendor/zlib/gzread.c" \
    "vendor/zlib/gzwrite.c" \
    "vendor/zlib/infback.c" \
    "vendor/zlib/inffast.c" \
    "vendor/zlib/inffast.h" \
    "vendor/zlib/inffixed.h" \
    "vendor/zlib/inflate.c" \
    "vendor/zlib/inflate.h" \
    "vendor/zlib/inftrees.c" \
    "vendor/zlib/inftrees.h" \
    "vendor/zlib/make_vms.com" \
    "vendor/zlib/treebuild.xml" \
    "vendor/zlib/trees.c" \
    "vendor/zlib/trees.h" \
    "vendor/zlib/uncompr.c" \
    "vendor/zlib/zconf.h" \
    "vendor/zlib/zconf.h.cmakein" \
    "vendor/zlib/zconf.h.in" \
    "vendor/zlib/zlib.3" \
    "vendor/zlib/zlib.3.pdf" \
    "vendor/zlib/zlib.h" \
    "vendor/zlib/zlib.map" \
    "vendor/zlib/zlib.pc.cmakein" \
    "vendor/zlib/zlib.pc.in" \
    "vendor/zlib/zlib2ansi" \
    "vendor/zlib/zutil.c" \
    "vendor/zlib/zutil.h"
}
